# از نرم افزار تا سخت افزار

در ادامه قصد داریم نگاهی عمیق تر به روند اجرای یک برنامه 
به زبان C داشته باشیم، اینکه چگونه کدهایی که برای ما خواناست تبدیل زبان
ماشین شده و قابل اجرا میشود.

قبل ازینکه به ادامه بحث بپردازیم نیاز داریم که به یک سری 
مفاهیم اشاره کنیم ،‌ یکی از آن مفاهیم کد ماشین هست. کد ماشین درواقع یک 
ترتیب خاص از توالی ۰ ها و ۱ ها است که برای ماشین و سخت افزار قابل فهم 
است درواقع تنها چیزی که برای یک ماشین قابل درک است ۰ و ۱ است.

حال این پرسش نمایان میشود که چگونه کدهایی که ما با نمادهای قابل فهم برای خودمان مینویسیم توسط ماشین اجرا میشود؟ حال باید نگاهی عمیق تر به سخت افزار داشت.

---

## مبانی سخت‌افزار و اجزای کامپیوتر

یک کامپیوتر از چند بخش اصلی تشکیل شده که هر یک وظیفه خاصی در پردازش داده‌ها و اجرای برنامه‌ها دارند. این اجزا شامل موارد زیر می‌شوند:

1. واحد پردازش مرکزی (CPU): مغز کامپیوتر است که دستورالعمل‌های برنامه‌ها را اجرا می‌کند. CPU شامل واحد کنترل (CU) و واحد حساب و منطق (ALU) است:

 + واحد کنترل (CU): جریان اطلاعات را در سیستم کنترل می‌کند و داده‌ها را از حافظه به CPU منتقل می‌کند.

 + واحد حساب و منطق (ALU): انجام عملیات محاسباتی و منطقی را بر عهده دارد.


2. حافظه (RAM): حافظه دسترسی تصادفی (Random Access Memory) جایی است که داده‌ها و برنامه‌ها به‌طور موقت در آن نگهداری می‌شوند تا CPU به آن‌ها دسترسی داشته باشد. این حافظه ناپایدار است؛ یعنی با خاموش شدن سیستم، اطلاعات آن از بین می‌رود.


3. حافظه دائمی (Hard Drive/SSD): اطلاعات به‌صورت دائمی در دیسک سخت (HDD) یا حافظه جامد (SSD) ذخیره می‌شود. این حافظه برای نگهداری داده‌ها حتی بعد از خاموش شدن سیستم مورد استفاده قرار می‌گیرد.


4. دستگاه‌های ورودی و خروجی (I/O Devices): دستگاه‌هایی مانند کیبورد، ماوس، مانیتور و چاپگر که برای ارتباط کاربر با کامپیوتر به‌کار می‌روند.


برد اصلی سیستم (MotherBoard) تمام قطعات سخت‌افزاری را به هم متصل می‌کند و به انتقال اطلاعات بین آن‌ها کمک می‌کند.

---

## نحوه اجرای یک برنامه C در سیستم

برای توضیح بهتر روند اجرا بگذارید از کدی که در قسمت قبلی بررسی شد استفاده کنیم:

```c
#include <stdio.h>

int main() {
   /* my first program in C */

   printf("Hello World! \n");
   return 0;
}
```

فرض کنیم اسم فایلی که این تکه کد در آن قرار دارد main.c است. پسوند c در واقع پسوندی است که برای فایل هایی که به زبان سی نوشته شده اند استفاده میشود.

اولین خط بیانگر یک دستور پیش پردازنده است که کار آن در این کد در دسترس قرار دادن کتابخانه stdio.h است.

> ینی چی در دسترس قرار دادن کتابخانه؟ اصلا کتابخانه چیه؟
> به زبان ساده کتابخانه مجموعه ایه از یک سری کدهای از قبل 
> آماده شده است که ما میتونیم از اونها استفاده کنیم بدون اینکه نیاز باشه 
> از اول خودمون اون کد رو بزنیم. به عنوان مثال با دستور printf به طور 
> مختصر در قسمت قبل آشنا شدید ،‌این دستور خودش یکی از دستورات کتابخانه 
>  که در پشت صحنه این دستور شامل جزییاتی در پیاده سازیه که در 
> کتابخانه stdio.h قرار گرفته.

نقطه شروع اجرای هر برنامه ای تابع main است. (با مفهوم تابع جلوتر آشنا میشید.) در واقع برنامه با اجرا کردن دستورات در این تابع اجرا میشود.

> در مثال ما تابع main شامل دو عبارت اجرا شدنی و یک کامنت است (کامنت ها هم جلوتر بررسی میشن.) تابع printf اون عبارتی که بهش دادیم را در صفحه نمایش به عنوان خروجی چاپ میکند و عبارت بعدی برنامه را ملزم به این میکند که اگربه شکل درست اجرا شد و به پایان رسید مقدار صفر را برگرداند.


#### مراحل اجرای یک برنامه C 

1. نوشتن برنامه (Source Code): ابتدا کد برنامه را با استفاده از یک ویرایشگر متن می‌نویسید. این کد با زبان C نوشته شده و شامل دستورالعمل‌هایی است که قرار است توسط کامپیوتر اجرا شود. این کد را به‌عنوان فایل منبع (source code) می‌شناسیم که با پسوند .c ذخیره می‌شود.


2. کامپایل کردن (Compilation): برنامه C به زبانی نوشته شده که برای کامپیوتر قابل فهم نیست. بنابراین باید این کد را به زبان ماشین ترجمه کرد. این کار توسط یک کامپایلر C انجام می‌شود (مثل gcc). کامپایلر کد منبع را به زبان ماشین تبدیل می‌کند که توسط پردازنده قابل درک است. نتیجه این مرحله یک فایل اجرایی (مانند .exe در ویندوز) است.

> درواقع به اون روندی که کد ما به کد ماشین تبدیل میشه کامپایل گفته میشه.
> به عنوان یک نکته باید توجه داشته باشیم که کد ماشین تولید شده بسیار مرتبط است با نوع معماری سخت افزار و نوع سیستم عامل. به همین دلیله که موقع نصب کامپایلر با نسخه های مختلف اون برای سیستم عامل های مختلف مواجه میشید. پس حتما به این موضوع توجه کنید.

3. لینک کردن (Linking): در این مرحله، اگر برنامه از کتابخانه‌ها و توابعی استفاده کند که در فایل‌های جداگانه‌ای قرار دارند (مثلاً توابع استاندارد C مثل printf)، باید این توابع با کد کامپایل شده شما ترکیب شوند. فرآیند لینک کردن این کار را انجام می‌دهد.


4. لود شدن به حافظه (Loading): پس از لینک کردن، سیستم عامل برنامه را از دیسک (حافظه دائمی) به حافظه RAM منتقل می‌کند تا آماده اجرا توسط CPU شود.


5. اجرای برنامه (Execution): حالا که برنامه در حافظه RAM بارگذاری شده است، CPU شروع به اجرای دستورالعمل‌های آن می‌کند. CPU دستورالعمل‌ها را به ترتیب از حافظه می‌خواند و آن‌ها را اجرا می‌کند.

---

## تفاوت زبان‌های سطح پایین و سطح بالا در نحوه اجرا

+ زبان‌های سطح بالا (High-level Languages):

تعریف: زبان‌هایی که نزدیک به زبان انسانی و دور از زبان ماشین هستند. مثال‌ها شامل C، Python، و Java است.

ترجمه به زبان ماشین: این زبان‌ها نیاز به ترجمه به زبان ماشین دارند تا CPU بتواند آن‌ها را اجرا کند. این کار توسط کامپایلر یا مفسر انجام می‌شود.


+ زبان‌های سطح پایین (Low-level Languages):

تعریف: زبان‌هایی که نزدیک به زبان ماشین هستند، مثل Assembly. در این زبان‌ها، دستورات مستقیماً به سخت‌افزار مربوط می‌شوند.

ترجمه به زبان ماشین: در زبان‌های سطح پایین مثل Assembly، کد برنامه تقریباً مستقیماً به دستورات ماشین ترجمه می‌شود، که باعث اجرای سریع‌تر برنامه می‌شود.

 ---

> هدف از این بخش این بود که بتونیم درک درستی از روند اجرا و 
> کامپایل بهتون منتقل کنیم. اما باید این نکته رو خاطر نشان کنیم که مباحث 
> این بخش پیچیده تر از اونیه که بشه کامل توضیح داد. اما اگه جزییات این 
> مطالب براتون مبهم بود جای نگرانی نیست صرفا هدف این بود که شما با کلیت 
> این موضوع در این مرحله آشنا بشید. جزییات بیشتر به مرور در جلسات بعدی در 
> ذهنتون جا باز میکنن.

