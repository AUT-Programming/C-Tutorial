# آرگومان‌های متغیر (Variable Arguments) در زبان C
در زبان C، تابعی که بتواند تعداد متغیری از آرگومان‌ها را بپذیرد، به عنوان تابعی با آرگومان‌های متغیر (Variable Arguments) شناخته می‌شود. این قابلیت به شما امکان می‌دهد که توابعی مانند printf را ایجاد کنید که بتوانند تعداد دلخواهی از آرگومان‌ها را بپذیرند.

برای پیاده‌سازی چنین توابعی، از کتابخانه استاندارد stdarg.h استفاده می‌شود که ابزارهای لازم برای کار با آرگومان‌های متغیر را فراهم می‌کند.

---


## نحوه استفاده از آرگومان‌های متغیر
برای تعریف یک تابع با آرگومان‌های متغیر، ابتدا باید آرگومان‌های ثابت (در صورت وجود) را تعریف کنید و سپس از سه نقطه (...) به عنوان نشانگر برای آرگومان‌های متغیر استفاده کنید.

### ابزارهای مهم از کتابخانه stdarg.h:
- va_list: یک نوع داده برای ذخیره آرگومان‌های متغیر
- va_start: این ماکرو برای مقداردهی اولیه به لیست آرگومان‌ها استفاده می‌شود
- va_arg: این ماکرو برای دسترسی به آرگومان‌های متغیر به ترتیب استفاده می‌شود
- va_end: این ماکرو برای پایان دادن به پردازش آرگومان‌های متغیر استفاده می‌شود
### ساختار کلی:
```c
#include <stdarg.h>
#include <stdio.h>

void function_name(int fixed_arg, ...) {
    va_list args;
    va_start(args, fixed_arg);

    // دسترسی به آرگومان‌های متغیر
    va_arg(args, type);

    va_end(args);
}
```
### مثال: تابعی برای جمع کردن چند عدد
در این مثال، تابعی تعریف می‌کنیم که تعداد دلخواهی از اعداد را گرفته و مجموع آن‌ها را محاسبه می‌کند:

```c
#include <stdio.h>
#include <stdarg.h>

int sum(int count, ...) {
    va_list args;
    int total = 0;

    va_start(args, count); // مقداردهی اولیه لیست آرگومان‌ها

    for (int i = 0; i < count; i++) {
        total += va_arg(args, int); // دریافت هر آرگومان به ترتیب
    }

    va_end(args); // پایان پردازش آرگومان‌ها

    return total;
}

int main() {
    printf("Sum of 2, 3, 4: %d\n", sum(3, 2, 3, 4));
    printf("Sum of 5, 10, 15, 20: %d\n", sum(4, 5, 10, 15, 20));
    return 0;
}
```
```mathematica
Sum of 2, 3, 4: 9
Sum of 5, 10, 15, 20: 50
```

در این مثال، تابع sum اولین آرگومان (یعنی count) را به عنوان تعداد اعداد گرفته و سپس از آرگومان‌های متغیر برای جمع کردن آن‌ها استفاده می‌کند. ما از va_arg برای دریافت هر عدد استفاده می‌کنیم و در نهایت va_end را برای پایان دادن به پردازش آرگومان‌ها فراخوانی می‌کنیم.

---


## کاربرد آرگومان‌های متغیر
توابعی که از آرگومان‌های متغیر استفاده می‌کنند، برای مواقعی مفید هستند که نمی‌دانید در زمان کامپایل، چه تعداد آرگومان نیاز دارید. برخی از کاربردهای رایج:
- printf و scanf: این توابع از آرگومان‌های متغیر استفاده می‌کنند تا بتوانند تعداد متغیری از ورودی‌ها یا خروجی‌ها را پردازش کنند

---


## نکات مهم:
- همیشه از va_start برای مقداردهی اولیه به لیست آرگومان‌های متغیر استفاده کنید.
- از va_arg برای دسترسی به هر آرگومان به ترتیب استفاده کنید.
- از va_end در پایان کار با آرگومان‌های متغیر استفاده کنید تا منابع سیستم آزاد شوند.
- باید دقیقاً بدانید چه تعداد و چه نوع آرگومان‌هایی به تابع خود می‌دهید، زیرا در C هیچ چک‌کردنی برای نوع داده‌های آرگومان‌های متغیر وجود ندارد و ممکن است منجر به خطاهای زمان اجرا شود.

## مثال: تابعی که رشته‌ها را چاپ می‌کند
در این مثال، تابعی تعریف می‌کنیم که چند رشته را به صورت متوالی چاپ می‌کند:

```c
#include <stdio.h>
#include <stdarg.h>

void print_strings(int count, ...) {
    va_list args;
    va_start(args, count);

    for (int i = 0; i < count; i++) {
        char *str = va_arg(args, char*);
        printf("%s\n", str);
    }

    va_end(args);
}

int main() {
    print_strings(3, "Hello", "World", "C Programming");
    return 0;
}
```
```mathematica
Hello
World
C Programming
```
در این مثال، تابع print_strings چندین رشته دریافت کرده و آن‌ها را چاپ می‌کند.